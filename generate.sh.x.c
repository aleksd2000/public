#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f generate.sh -o github-generate 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[4]))
	"\164\024\004\147\225\354\360\241\304\056\317\040\333\103\346\201"
	"\330\141\372\261\337\125\057\114\200\306\160"
#define      xecc_z	15
#define      xecc	((&data[30]))
	"\233\124\147\016\112\306\271\154\245\255\227\306\071\076\217\221"
	"\221\311\105"
#define      pswd_z	256
#define      pswd	((&data[70]))
	"\126\325\241\144\374\034\357\236\065\053\236\043\013\022\067\020"
	"\172\204\221\100\364\364\056\102\150\145\146\363\203\054\006\342"
	"\201\046\017\046\366\310\003\124\042\171\023\310\246\232\314\264"
	"\034\254\017\077\344\353\007\115\120\156\100\324\232\106\266\034"
	"\154\306\102\143\216\105\267\261\277\313\171\146\146\105\032\203"
	"\361\052\302\326\025\311\043\145\070\144\072\322\252\361\357\027"
	"\267\061\172\106\167\062\367\067\376\160\235\144\265\270\347\247"
	"\343\252\176\370\164\241\136\254\006\230\177\260\211\156\310\101"
	"\240\103\207\030\166\177\117\164\357\355\330\245\246\300\115\211"
	"\153\313\201\340\155\340\215\163\170\015\044\002\174\354\103\034"
	"\060\313\064\246\112\204\032\071\161\363\337\027\264\054\240\037"
	"\367\042\000\145\002\215\330\173\233\374\175\027\351\301\063\031"
	"\214\150\300\326\354\332\017\135\315\357\165\201\033\025\241\023"
	"\070\242\170\072\060\121\265\313\116\063\342\067\364\026\121\200"
	"\176\021\126\153\354\146\311\271\125\076\073\161\124\335\205\214"
	"\177\375\307\257\117\174\173\235\260\135\324\244\164\046\044\363"
	"\067\173\136\044\342\047\335\070\146\031\251\272\367\056\107\166"
	"\054\016\046\173\213\242\030\073\217\202\252\324\221\010\111\347"
	"\336\352\114\332\007\074\170\075\147\027\140\162\051\230\202\244"
	"\035\023\344\021\010"
#define      msg1_z	65
#define      msg1	((&data[360]))
	"\225\376\154\047\007\045\307\262\024\060\206\321\130\066\216\314"
	"\042\212\255\120\061\217\157\242\373\275\354\111\100\064\110\251"
	"\136\333\117\347\203\041\361\003\140\242\322\142\217\003\302\073"
	"\174\073\330\361\044\106\172\231\323\130\371\254\213\353\000\357"
	"\370\031\167\320\176\275\265\017\345\240\133\277\247\227\070\344"
#define      date_z	1
#define      date	((&data[435]))
	"\025"
#define      lsto_z	1
#define      lsto	((&data[436]))
	"\075"
#define      shll_z	10
#define      shll	((&data[437]))
	"\116\303\372\336\077\356\175\065\256\170\010\002"
#define      inlo_z	3
#define      inlo	((&data[449]))
	"\025\164\113"
#define      tst1_z	22
#define      tst1	((&data[455]))
	"\137\024\322\044\142\262\117\216\062\065\174\003\372\346\025\254"
	"\314\305\120\212\242\356\155\047\255\146\312\341\114"
#define      chk1_z	22
#define      chk1	((&data[482]))
	"\022\357\357\371\146\246\336\044\172\244\322\311\273\256\257\313"
	"\241\330\227\322\151\345\340"
#define      text_z	1119
#define      text	((&data[579]))
	"\322\225\075\104\017\033\070\055\027\100\060\044\121\105\206\371"
	"\360\346\016\303\114\331\244\231\104\341\245\126\265\352\116\210"
	"\177\213\314\216\247\005\274\276\106\354\343\227\062\151\221\042"
	"\117\237\346\234\170\212\065\274\154\332\023\041\305\141\252\104"
	"\355\167\323\224\174\220\122\302\174\066\132\310\000\365\311\103"
	"\153\235\350\012\312\032\140\266\116\375\120\107\361\130\047\245"
	"\015\070\032\375\226\114\031\335\257\226\314\064\044\364\025\004"
	"\331\331\234\336\065\036\366\363\261\262\333\200\317\322\334\220"
	"\345\067\377\127\037\066\113\127\133\170\006\142\016\312\251\375"
	"\277\306\170\174\247\041\167\140\004\202\205\262\063\200\262\273"
	"\214\113\155\136\061\176\175\264\022\143\125\235\046\057\305\256"
	"\317\174\152\055\062\225\173\070\371\324\310\342\134\076\075\355"
	"\342\023\124\247\106\104\007\304\070\026\200\221\101\043\076\223"
	"\262\166\314\142\347\057\206\257\102\073\173\363\014\341\070\303"
	"\352\203\153\115\331\332\021\022\004\341\227\176\252\046\104\212"
	"\145\121\073\353\230\211\142\106\266\115\224\357\141\075\065\027"
	"\075\011\305\227\257\071\126\230\157\104\265\022\265\340\226\271"
	"\202\130\277\042\110\107\170\143\340\024\311\244\324\254\351\126"
	"\307\360\012\263\161\343\036\121\275\001\005\334\145\303\107\065"
	"\344\276\240\355\220\344\312\054\156\340\012\371\223\033\373\124"
	"\210\014\107\302\204\315\214\235\320\352\372\346\277\013\365\016"
	"\261\325\364\270\062\132\341\244\265\310\204\147\321\270\105\146"
	"\020\240\032\023\251\332\061\112\112\216\012\005\221\134\313\374"
	"\114\074\117\116\107\205\227\037\247\201\110\003\221\166\141\037"
	"\331\042\336\361\370\020\135\361\207\350\151\207\333\060\370\330"
	"\072\322\330\022\076\000\251\157\222\340\363\375\377\110\163\247"
	"\211\265\024\225\355\246\223\132\223\167\040\354\157\132\054\244"
	"\034\156\064\133\213\124\247\117\151\205\064\324\320\173\113\357"
	"\277\173\126\132\220\226\320\147\035\010\340\363\246\315\265\072"
	"\205\017\113\130\030\101\022\174\172\040\172\333\021\332\323\333"
	"\113\247\223\353\307\332\112\175\035\306\131\057\250\060\125\202"
	"\124\032\110\341\060\316\166\120\302\043\023\333\033\272\030\330"
	"\124\311\353\316\214\175\067\036\251\224\211\377\003\276\120\246"
	"\014\325\355\333\040\023\073\261\073\260\205\176\062\173\346\213"
	"\110\175\311\335\137\330\365\263\327\250\355\102\321\247\305\144"
	"\136\223\134\346\011\034\002\313\300\124\320\020\271\013\035\277"
	"\101\316\046\211\350\331\107\317\175\230\202\262\326\305\262\307"
	"\026\161\021\007\052\136\075\206\245\362\164\367\376\333\141\057"
	"\331\220\355\330\350\314\233\012\301\317\256\051\300\245\014\210"
	"\150\345\213\231\213\215\345\254\316\045\330\062\201\337\050\225"
	"\102\105\253\305\323\115\043\264\250\110\070\037\101\213\216\051"
	"\263\273\122\260\037\113\265\356\170\264\174\256\231\026\026\070"
	"\220\007\377\267\223\261\167\274\251\275\156\201\261\127\274\056"
	"\055\024\114\336\244\070\105\002\242\067\133\326\026\067\252\175"
	"\013\316\040\112\253\072\110\277\216\210\014\237\166\071\322\270"
	"\050\137\374\246\140\032\250\150\125\147\356\271\011\127\024\311"
	"\151\125\131\346\347\015\014\323\202\313\314\175\051\310\347\163"
	"\241\021\073\144\001\202\031\312\132\045\267\067\376\253\006\061"
	"\134\331\045\123\327\321\161\131\123\352\020\207\355\003\124\242"
	"\122\163\143\133\067\236\105\051\300\060\321\130\071\034\240\074"
	"\146\306\162\316\176\067\221\143\072\211\271\336\273\117\316\327"
	"\220\124\250\277\347\146\332\272\231\216\345\135\064\077\036\111"
	"\151\265\144\277\132\140\056\330\072\117\272\365\017\227\275\266"
	"\225\302\067\317\272\050\350\053\114\103\332\272\133\005\126\030"
	"\332\107\301\061\361\215\146\001\341\263\111\017\113\232\032\160"
	"\156\344\160\223\173\313\005\164\302\070\326\335\336\303\054\223"
	"\332\333\313\346\171\271\014\317\167\322\047\144\022\176\000\007"
	"\357\033\207\051\207\040\253\302\216\040\162\205\212\033\137\042"
	"\200\063\156\076\262\056\332\340\232\027\035\002\266\363\324\321"
	"\006\176\211\154\345\355\204\315\033\237\104\001\071\216\212\040"
	"\135\052\364\266\140\151\270\345\136\325\200\145\374\312\123\207"
	"\274\146\040\316\342\372\374\325\036\035\043\372\303\062\376\011"
	"\205\271\337\335\301\216\353\173\065\013\157\362\110\162\236\311"
	"\122\217\207\153\023\344\361\073\303\222\342\174\302\105\263\307"
	"\024\376\136\113\325\032\075\342\152\135\371\330\115\214\145\155"
	"\020\030\237\266\254\207\245\174\200\145\073\176\135\143\173\234"
	"\055\165\131\121\130\153\363\175\250\073\177\333\105\025\364\325"
	"\153\334\104\125\170\275\331\136\316\206\306\254\325\247\143\015"
	"\214\076\305\263\045\265\053\073\016\322\121\170\372\135\311\211"
	"\200\171\307\002\214\326\214\143\345\253\164\363\220\001\373\120"
	"\143\241\072\335\072\222\107\146\216\116\356\362\066\116\262\147"
	"\144\362\102\253\150\312\136\211\135\244\301\240\300\275\200\076"
	"\154\050\056\340\114\352\147\317\060\371\133\007\014\211\031\370"
	"\203\163\156\214\035\002\003\175\106\363\065\330\277\155\203\131"
	"\026\051\141\322\107\323\326\365\317\364\256\237\353\321\357\212"
	"\267\214\002\102\301\277\256\234\322\320\142\064\172\247\041\362"
	"\172\266\156\012\010\061\207\077\213\065\336\166\006\316\000\276"
	"\132\003\000\034\303\256\270\226\177\033\312\372\302\354\354\074"
	"\242\133\107\253\214\316\352\027\004\311\215\013\227\216\311\362"
	"\222\311\016\125\170\307\354\370\342\266\362\244\243\337\341\106"
	"\072\051\362\306\370\334\335\374\246\153\010\075\372\321\060\215"
	"\233\076\342\024\006\316\014\350\205\377\215\051\336\157\157\030"
	"\230\141\336\221\076\274\215\344\050\226\042\043\147\122\260\003"
	"\221\223\027\227\141\044\200\347\043\016\021\002\175\201\032\026"
	"\343\371\247\041\266\065\006\337\313\051\002\063\174\262\066\015"
	"\105\116\245\247\163\046\217\227\064\240\231\262\041\264\310\005"
	"\256\160\046\144\245\055\104\160\126\106\244\322\371\332\340\077"
	"\051\206\346\234\254\166\063\341\027\315\223\070\201\134\076\060"
	"\314\145\225\162\222\331\343\351\040\207\274\031\142\234\131\213"
	"\043\100\047\317\266\133\261\315\051\105\006\252\241\104\332\156"
	"\251\160\340\074\111\303\045\151\112\341\203\254\176\334\067\241"
	"\034\137\161\323\273\043\240\344"
#define      msg2_z	19
#define      msg2	((&data[1971]))
	"\011\353\152\015\066\246\364\066\367\240\162\233\223\045\147\355"
	"\320\000\071\111\121\170\167\225"
#define      tst2_z	19
#define      tst2	((&data[1993]))
	"\043\133\310\065\237\101\012\076\352\155\007\177\306\214\062\116"
	"\120\065\222\031\033\366\215\146"
#define      rlax_z	1
#define      rlax	((&data[2016]))
	"\201"
#define      opts_z	1
#define      opts	((&data[2017]))
	"\007"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
